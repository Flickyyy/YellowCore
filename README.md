# YellowCore - Техническое Задание

## ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### Аутентификация
- пользователь может зарегистрироваться (логин/пароль)
- пользователь может войти в систему
- пользователь может выйти из системы (logout)
- при неверных кредентиалах — доступ запрещён, выводится ошибка

### Управление счетами
- пользователь может создать новый счет (с начальным балансом и валютой)
- пользователь может просмотреть баланс любого своего счета
- пользователь может просмотреть список всех своих счетов
- пользователь может закрыть счет (при условии нулевого баланса)
- система поддерживает несколько валют (RUB, USD, EUR)

### Операции с деньгами
- пользователь может пополнить счет
- пользователь может снять деньги со счета
- пользователь может перевести деньги между своими счетами
- пользователь может отправить деньги другому пользователю (по логину или номеру счета)
- при попытке операции, превышающей баланс — выводится ошибка
- при попытке операции с отрицательной суммой — выводится ошибка

### История и отчеты
- пользователь может просмотреть полную историю операций по счету
- история содержит: дату, тип операции, сумму, баланс после операции, контрагента
- пользователь может фильтровать историю по дате и типу операции

### Торговля акциями
- пользователь может просмотреть список доступных акций с текущими котировками
- котировки обновляются в реальном времени (симуляция рыночных изменений на сервере)
- пользователь получает push-уведомление при значительном изменении цены акции из его портфеля
- пользователь может купить акцию по текущей цене (деньги списываются с выбранного счета)
- пользователь может продать акцию по текущей цене (деньги зачисляются на выбранный счет)
- пользователь может просмотреть свой инвестиционный портфель (кол-во акций, текущая стоимость, P&L)
- при нехватке средств на счете — операция отклоняется
- история сделок хранится отдельно от банковских операций

---

## НЕФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### Архитектура
- клиент-серверная архитектура, взаимодействие по TCP, протокол обмена — JSON
- многопоточный сервер (Boost.Asio) + многопоточный клиент (Qt)
- разделение бизнес-логики, сетевого слоя и представления

### Многопоточность
- **Сервер**: thread pool для одновременной обработки нескольких клиентов (Boost.Asio)
- **Сервер**: критические секции защищены `std::mutex` (изменение баланса, истории, портфеля)
- **Сервер**: `std::shared_mutex` для котировок акций (частое чтение — редкая запись)
- **Сервер**: `std::atomic` для счетчиков, флагов и состояний без блокировок
- **Сервер**: `std::condition_variable` для планировщика обновления котировок (price engine thread)
- **Сервер**: producer-consumer очередь для push-уведомлений клиентам об изменении котировок
- **Сервер**: покупка/продажа акций атомарна относительно баланса счета (no partial execution)
- **Клиент**: сетевая коммуникация в отдельном потоке (не блокирует UI)
- **Клиент**: обновление интерфейса через Qt signals/slots (потокобезопасно)

### Надежность
- все финансовые операции атомарны (нет partial transfers / partial trades)
- при сбое соединения — операция либо завершается, либо полностью откатывается
- сервер корректно завершается (graceful shutdown): дожидается завершения активных операций
- все ошибки (сетевые, валидационные, логические) обрабатываются явно и возвращаются клиенту

### Хранение данных
- данные хранятся в памяти (in-memory репозитории)
- опционально: сериализация состояния в JSON-файл при завершении сервера

### Логирование
- сервер логирует все входящие запросы и ответы
- сервер логирует старт/стоп потоков и критические события

### Графический интерфейс (Qt)
- форма авторизации (вход / регистрация)
- экран со списком счетов и балансом
- форма для выполнения операций (пополнение, снятие, перевод)
- отображение истории операций (таблица с сортировкой)
- экран торговли акциями: таблица котировок с live-обновлением
- экран инвестиционного портфеля: позиции, P&L
- отображение статуса операции (в обработке, успешно, ошибка)
- всплывающие уведомления о входящих платежах и изменениях котировок

### Тестирование
- **Сервер**: unit-тесты (GoogleTest) для бизнес-логики (транзакции, валидация, торговля)
- **Сервер**: unit-тесты на потокобезопасность (конкурентные операции, race conditions)
- **Сервер**: интеграционные тесты (client-server communication)
- **Клиент**: unit-тесты (Qt Test) для критических компонентов
- **Общее**: стресс-тесты (одновременные операции от нескольких клиентов)
- покрытие кода тестами — не менее 70%
